---
git:
  branch: main
  commit: f6915b1
  dirty: true
  files_changed:
  - TODO.md
  - crates/julie-extractors/src/razor/csharp.rs
  - crates/julie-extractors/src/razor/directives.rs
  - crates/julie-extractors/src/razor/mod.rs
  - crates/julie-extractors/src/razor/stubs.rs
  - crates/julie-extractors/src/tests/razor/mod.rs
  - crates/julie-extractors/src/tests/razor/relationships.rs
  - src/tools/search/text_search.rs
  - src/tools/workspace/indexing/processor.rs
id: checkpoint_6987cf01_672df2
tags:
- razor
- dogfood
- noise-reduction
- reference-workspace
- symbol-extraction
timestamp: 1770508033
type: checkpoint
---

## Razor Extractor Dogfood Fixes — Complete

### Changes Made (6 tasks across 6 files)

**Phase 1: Reference Workspace Definition Search (P0)**
- `src/tools/search/text_search.rs` — Added dual-path routing for reference workspace search
  - Renamed `_workspace_ids` → `workspace_ids` (was being ignored)
  - Opens isolated Tantivy + SQLite for reference workspaces
  - Extracted `tantivy_symbol_to_symbol()` and `enrich_symbols_from_db()` helpers

**Phase 2: Razor Noise Reduction (P1)**
- `crates/julie-extractors/src/razor/mod.rs` — Removed template noise extraction
  - Removed `extract_template_components()` call (regex-based PascalCase scanning)
  - Disabled `extract_html_element`, `extract_component`, `extract_html_attribute` paths
  - Component usages and HTML attributes no longer create symbols
- `crates/julie-extractors/src/razor/stubs.rs` — Fixed `unknownVariable` sentinel
  - Changed to `Option<String>` with early return `None`
- `crates/julie-extractors/src/razor/csharp.rs` — Fixed `unknownMethod`/`unknownProperty` sentinels
  - Same `Option<String>` pattern
- `crates/julie-extractors/src/razor/directives.rs` — Fixed `@inherits` → `SymbolKind::Import`

**Phase 3: symbol_count Bug Fix (P2)**
- `src/tools/workspace/indexing/processor.rs` — `file_info.symbol_count = symbols.len() as i32`

### Test Updates (7 tests fixed)
- `test_blazor_components_extracted` — reversed assertions
- `test_component_after_razor_expression_not_extracted` — renamed + reversed
- `test_full_blazor_component_extraction` — ChildComponent assertion flipped
- `test_extract_component_relationships_and_dependencies` — replaced component usage checks with C# symbol checks
- `test_extract_two_way_binding_event_handlers_and_form_validation` — removed binding attribute assertions
- `test_component_identifier_relationship` — verifies AlertBanner NOT extracted
- `test_component_invoke_async_relationship_targets_component_symbol` — verifies FeaturedProducts NOT extracted

### Results
- **27 Razor tests: all pass**
- **653 lib tests: all pass, 0 failures**
- Dead code warnings in `html.rs` (methods no longer called from `mod.rs`)
