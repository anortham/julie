---
git:
  branch: main
  commit: bba0e63
  dirty: true
  files_changed:
  - .claude/agents/rust-refactor-specialist.md
  - .claude/agents/rust-tdd-implementer.md
  - .claude/agents/sqlite-fts5-tdd-expert.md
  - .claude/agents/sqlite-rust-expert.md
  - .claude/commands/README.md
  - .claude/commands/checkpoint.md
  - .claude/skills/development-memory
  - .claude/skills/explore-codebase
  - .claude/skills/plan-tracking
  - .claude/skills/safe-refactor
  - .claude/skills/semantic-intelligence
  - .claude/skills/smart-search
  - .sherpa/active-workflow.md
  - src/search/index.rs
  - src/tests/memory_checkpoint_tests.rs
  - src/tests/memory_sql_views_tests.rs
  - src/tests/tools/workspace/discovery.rs
  - src/tools/workspace/discovery.rs
  - src/tools/workspace/indexing/index.rs
id: checkpoint_69851356_68293e
tags:
- bugfix
- memory
- search
- limit
- ranking
timestamp: 1770328918
type: checkpoint
---

Fixed search limit bug: limit was applied before scoring (during recall_memories loading), meaning search with limit=5 only searched the 5 newest memories. Now limit is stripped from recall options and applied via TopDocs::with_limit() after BM25 ranking. Added regression test. 71/71 memory tests pass.
