---
git:
  branch: main
  commit: a3f64bc
  dirty: true
  files_changed:
  - .memories/plans/plan_phase-3-priority-1-fast-search-improvements.json
  - docs/plans/PROGRESS.md
id: checkpoint_6985fc2f_4e45d7
tags:
- trace_call_path
- audit
- phase3
- priority4
- agent-teams
- bugs
- data-utilization
timestamp: 1770388527
type: checkpoint
---

Phase 3 Priority 4: trace_call_path audit COMPLETE (3 parallel agents).

## Critical Bugs:
1. direction=both broken — shared visited set means downstream sees everything as already visited (mod.rs:308-329)
2. ~40% false positive leaf nodes — stdlib/trait methods (to_string, clone, insert, len) resolve to random fixture file symbols via name-based lookup
3. Method calls on structs not tracked — row_to_symbol has 10 callers per fast_refs but trace finds 0

## Data Utilization: ~15-20%
- identifiers table: 0% used (63K+ entries completely ignored — kind="call" + containing_symbol_id gives caller→callee)
- relationships table: only Calls+References used (2 of 14 kinds) — missing Extends, Implements, Uses
- types table: 0% used
- Tantivy: 0% used

## Dead Code:
- handler param threaded through all recursive calls but NEVER accessed in tracing.rs
- similarity: Option<f32> always None (semantic search remnant) in types.rs + tracing.rs + formatting.rs
- create_result has 4 unused params with wasted allocations at 6 call sites (mod.rs:63-71)
- cross_language.rs: find_cross_language_callers and find_cross_language_callees are 100% identical code
- Wrong #[allow(dead_code)] on CallPathNode fields that ARE used (types.rs:53-60)
- calculate_max_depth has semantically incorrect math (formatting.rs:232-245)

## What Works Well:
- Lean ASCII tree output excellent for AI agents
- Depth limiting + cycle detection correct
- Hub symbol protection solid (MAX_CALLERS=50, MAX_NODES=500)
- Performance great (sub-second)
- Good error messages for missing symbols
