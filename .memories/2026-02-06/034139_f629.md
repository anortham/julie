---
git:
  branch: main
  commit: 40ac5d3
  dirty: true
  files_changed:
  - .memories/plans/plan_phase-3-priority-1-fast-search-improvements.json
id: learning_698562f3_187e7c
tags:
- bug
- overflow
- creation_methods
- find_containing_symbol
- tree-sitter
timestamp: 1770349299
type: learning
---

Investigated subtract-with-overflow panic in creation_methods.rs:196-197. Root cause: find_containing_symbol() computes symbol size as `(end_line - start_line) * 1000 + (end_column - start_column)` using u32 arithmetic. For multi-line symbols, end_column and start_column refer to DIFFERENT lines, so end_column < start_column is extremely common (e.g., indented Python function starting at column 4, closing at column 0). This causes u32 underflow panic. Pre-existing bug from 2025-11-02 (commit 52d52c3e), not related to Tantivy migration. Affects 15 identifier extractors across all languages. Recommended fix: replace both lines with `let size = a.end_byte - a.start_byte` which is always valid and more accurate.
